{# Reusable SEO + Social meta include
   Usage (in a child template BEFORE you extend base, or set in a controller):
   {% set meta = {
       title: 'Page title — XLMFISH',
       description: 'Brief page description for search engines and social cards.',
       image: 'images/social-card-page.png',            # path relative to public/
       url: absolute_url(app.request.uri),             # full canonical url
       type: 'website' | 'article',
       twitter_card: 'summary_large_image',
       twitter_site: '@xlmfish',
       twitter_creator: '@projectAuthor',
       logo_image: 'images/logo.png'                   # optional logo for JSON-LD
   } %}
   Then include: {% include '_meta.html.twig' with {'meta': meta} %}
#}

{# Defaults #}
{% set _meta = meta|default({}) %}
{% set site_defaults = {
    title: 'XLMFISH — Transparency & Analytics',
    description: 'XLMFISH: transparency, analytics, and community tools for the Stellar ecosystem.',
    image: 'images/social-card.png',
    twitter_site: '@xlmfish',
    type: 'website',
    logo_image: 'images/logo.png'
} %}

{% set title = _meta.title|default(site_defaults.title) %}
{% set description = _meta.description|default(site_defaults.description) %}
{% set image_path = _meta.image|default(site_defaults.image) %}
{% set image_url = image_path ? absolute_url(asset(image_path)) : '' %}
{% set url = _meta.url|default(app.request.uri) %}
{% set og_type = _meta.type|default(site_defaults.type) %}
{% set twitter_card = _meta.twitter_card|default('summary_large_image') %}
{% set twitter_site = _meta.twitter_site|default(site_defaults.twitter_site) %}
{% set twitter_creator = _meta.twitter_creator|default(twitter_site) %}
{% set logo_image = _meta.logo_image|default(site_defaults.logo_image) %}
{% set logo_url = logo_image ? absolute_url(asset(logo_image)) : '' %}

<title>{{ title }}</title>
<meta name="description" content="{{ description|striptags|trim|e('html_attr') }}"/>
<meta name="robots" content="{{ _meta.robots|default('index,follow') }}"/>

<link rel="canonical" href="{{ url }}"/>

{# Open Graph (used by Facebook, Telegram previews, many IMs) #}
<meta property="og:locale" content="{{ app.request.locale|default('en_US') }}"/>
<meta property="og:type" content="{{ og_type }}"/>
<meta property="og:title" content="{{ title }}"/>
<meta property="og:description" content="{{ description|striptags|trim }}"/>
<meta property="og:url" content="{{ url }}"/>
{% if image_url %}
  <meta property="og:image" content="{{ image_url }}"/>
  {# Optional: provide dimensions if known to improve rendering #}
  {% if _meta.image_width is defined %}<meta property="og:image:width" content="{{ _meta.image_width }}"/>{% endif %}
  {% if _meta.image_height is defined %}<meta property="og:image:height" content="{{ _meta.image_height }}"/>{% endif %}
{% endif %}

{# Twitter Card #}
<meta name="twitter:card" content="{{ twitter_card }}"/>
<meta name="twitter:site" content="{{ twitter_site }}"/>
<meta name="twitter:creator" content="{{ twitter_creator }}"/>
<meta name="twitter:title" content="{{ title }}"/>
<meta name="twitter:description" content="{{ description|striptags|trim }}"/>
{% if image_url %}<meta name="twitter:image" content="{{ image_url }}"/>{% endif %}

{# Misc - generator / viewport (keep where applicable) #}
<meta name="viewport" content="width=device-width, initial-scale=1"/>

{# JSON-LD structured data (WebSite + Publisher). Adjust/extend as needed per-page. #}
{% set jsonld = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "url": url,
  "name": title,
  "description": description,
  "publisher": {
    "@type": "Organization",
    "name": "XLMFISH",
    "logo": {
      "@type": "ImageObject",
      "url": logo_url
    }
  }
} %}

<script type="application/ld+json">{{ jsonld|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_PRETTY_PRINT'))|raw }}</script>

{# Allow pages to inject extra meta tags if needed #}
{% block extra_meta %}{% endblock %}